// Nextflow configuration for different execution environments

params {
    input = "samplesheet.csv"
    outdir = "results"
}

profiles {
    // Local execution (default)
    standard {
        process.executor = 'local'
        process.cpus = 2
        process.memory = '4 GB'
    }
    
    // SLURM cluster execution
    slurm {
        process {
            executor = 'slurm'

            // Default resources
            cpus = 2
            memory = '4 GB'
            time = '1h'

            // Process-specific resources
            withName: spades_assembly {
                cpus = 8
                memory = '16 GB'
                time = '4h'
            }
            
            withName: trimmomatic {
                cpus = 4
                memory = '8 GB'
                time = '2h'
            }
            
            withName: 'fastqc.*' {
                cpus = 2
                memory = '4 GB'
                time = '30m'
            }
        }
        
        executor {
            queueSize = 20
            submitRateLimit = '10 sec'
        }
    }
    

    
    // High-memory profile for large datasets
    highmem {
        process {
            executor = 'slurm'

            withName: spades_assembly {
                cpus = 16
                memory = '64 GB'
                time = '8h'
            }
            
            withName: trimmomatic {
                cpus = 8
                memory = '16 GB'
                time = '4h'
            }
        }
    }
    
    // Testing profile with reduced resources
    test {
        params.outdir = "test_results"
        
        process {
            cpus = 1
            memory = '2 GB'
            time = '30m'
            
            withName: spades_assembly {
                cpus = 2
                memory = '4 GB'
                time = '1h'
            }
        }
    }
}

// Enable trace and timeline reports
trace {
    enabled = true
    file = "${params.outdir}/pipeline_trace.txt"
}

timeline {
    enabled = true
    file = "${params.outdir}/pipeline_timeline.html"
}

report {
    enabled = true
    file = "${params.outdir}/pipeline_report.html"
}

// Resource monitoring
tower {
    enabled = false
    // endpoint = 'https://tower.nf'
    // accessToken = 'your_token_here'
}

// Include additional configuration files
includeConfig 'cluster.config'
